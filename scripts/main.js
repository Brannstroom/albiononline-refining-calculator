const resources = {
    fiber: [
        {
            name: "Cotton",
            image: "fiber/T2_FIBER.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
        },
        {
            name: "Flax",
            image: "fiber/T3_FIBER.png",
            item_value: 2,
            tier: 3,
            enchant: 0,
        },
        {
            name: "Hemp",
            image: "fiber/T4_FIBER.png",
            item_value: 4,
            tier: 4,
            enchant: 0,
        },
        {
            name: "Uncommon Hemp",
            image: "fiber/T4_FIBER_LEVEL1.png",
            item_value: 12,
            tier: 4,
            enchant: 1,
        },
        {
            name: "Rare Hemp",
            image: "fiber/T4_FIBER_LEVEL2.png",
            item_value: 28,
            tier: 4,
            enchant: 2,
        },
        {
            name: "Exceptional Hemp",
            image: "fiber/T4_FIBER_LEVEL3.png",
            item_value: 60,
            tier: 4,
            enchant: 3,
        },
        {
            name: "Pristine Hemp",
            image: "fiber/T4_FIBER_LEVEL4.png",
            item_value: 120,
            tier: 4,
            enchant: 4,
        },
        {
            name: "Skyflower",
            image: "fiber/T5_FIBER.png",
            item_value: 4,
            tier: 5,
            enchant: 0,
        },
        {
            name: "Uncommon Skyflower",
            image: "fiber/T5_FIBER_LEVEL1.png",
            item_value: 10,
            tier: 5,
            enchant: 1,
        },
        {
            name: "Rare Skyflower",
            image: "fiber/T5_FIBER_LEVEL2.png",
            item_value: 21,
            tier: 5,
            enchant: 2,
        },
        {
            name: "Exceptional Skyflower",
            image: "fiber/T5_FIBER_LEVEL3.png",
            item_value: 42,
            tier: 5,
            enchant: 3,
        },
        {
            name: "Pristine Skyflower",
            image: "fiber/T5_FIBER_LEVEL4.png",
            item_value: 85,
            tier: 5,
            enchant: 4,
        },
        {
            name: "Amberleaf Cotton",
            image: "fiber/T6_FIBER.png",
            item_value: 8,
            tier: 6,
            enchant: 0,
        },
        {
            name: "Uncommon Amberleaf Cotton",
            image: "fiber/T6_FIBER_LEVEL1.png",
            item_value: 16,
            tier: 6,
            enchant: 1,
        },
        {
            name: "Rare Amberleaf Cotton",
            image: "fiber/T6_FIBER_LEVEL2.png",
            item_value: 32,
            tier: 6,
            enchant: 2,
        },
        {
            name: "Exceptional Amberleaf Cotton",
            image: "fiber/T6_FIBER_LEVEL3.png",
            item_value: 64,
            tier: 6,
            enchant: 3,
        },
        {
            name: "Pristine Amberleaf Cotton",
            image: "fiber/T6_FIBER_LEVEL4.png",
            item_value: 128,
            tier: 6,
            enchant: 4,
        },
        {
            name: "Sunflax",
            image: "fiber/T7_FIBER.png",
            item_value: 12,
            tier: 7,
            enchant: 0,
        },
        {
            name: "Uncommon Sunflax",
            image: "fiber/T7_FIBER_LEVEL1.png",
            item_value: 25,
            tier: 7,
            enchant: 1,
        },
        {
            name: "Rare Sunflax",
            image: "fiber/T7_FIBER_LEVEL2.png",
            item_value: 51,
            tier: 7,
            enchant: 2,
        },
        {
            name: "Exceptional Sunflax",
            image: "fiber/T7_FIBER_LEVEL3.png",
            item_value: 102,
            tier: 7,
            enchant: 3,
        },
        {
            name: "Pristine Sunflax",
            image: "fiber/T7_FIBER_LEVEL4.png",
            item_value: 204,
            tier: 7,
            enchant: 4,
        },
        {
            name: "Ghost Hemp",
            image: "fiber/T8_FIBER.png",
            item_value: 25,
            tier: 8,
            enchant: 0,
        },
        {
            name: "Uncommon Ghost Hemp",
            image: "fiber/T8_FIBER_LEVEL1.png",
            item_value: 51,
            tier: 8,
            enchant: 1,
        },
        {
            name: "Rare Ghost Hemp",
            image: "fiber/T8_FIBER_LEVEL2.png",
            item_value: 102,
            tier: 8,
            enchant: 2,
        },
        {
            name: "Exceptional Ghost Hemp",
            image: "fiber/T8_FIBER_LEVEL3.png",
            item_value: 204,
            tier: 8,
            enchant: 3,
        },
        {
            name: "Pristine Ghost Hemp",
            image: "fiber/T8_FIBER_LEVEL4.png",
            item_value: 409,
            tier: 8,
            enchant: 4,
        }
    ],
    ore: [
        {
            name: "Copper Ore",
            image: "ore/T2_ORE.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
        },
        {
            name: "Tin Ore",
            image: "ore/T3_ORE.png",
            item_value: 2,
            tier: 3,
            enchant: 0,
        },
        {
            name: "Iron Ore",
            image: "ore/T4_ORE.png",
            item_value: 4,
            tier: 4,
            enchant: 0,
        },
        {
            name: "Uncommon Iron Ore",
            image: "ore/T4_ORE_LEVEL1.png",
            item_value: 12,
            tier: 4,
            enchant: 1,
        },
        {
            name: "Rare Iron Ore",
            image: "ore/T4_ORE_LEVEL2.png",
            item_value: 28,
            tier: 4,
            enchant: 2,
        },
        {
            name: "Exceptional Iron Ore",
            image: "ore/T4_ORE_LEVEL3.png",
            item_value: 60,
            tier: 4,
            enchant: 3,
        },
        {
            name: "Pristine Iron Ore",
            image: "ore/T4_ORE_LEVEL4.png",
            item_value: 120,
            tier: 4,
            enchant: 4,
        },
        {
            name: "Titanium Ore",
            image: "ore/T5_ORE.png",
            item_value: 4,
            tier: 5,
            enchant: 0,
        },
        {
            name: "Uncommon Titanium Ore",
            image: "ore/T5_ORE_LEVEL1.png",
            item_value: 10,
            tier: 5,
            enchant: 1,
        },
        {
            name: "Rare Titanium Ore",
            image: "ore/T5_ORE_LEVEL2.png",
            item_value: 21,
            tier: 5,
            enchant: 2,
        },
        {
            name: "Exceptional Titanium Ore",
            image: "ore/T5_ORE_LEVEL3.png",
            item_value: 42,
            tier: 5,
            enchant: 3,
        },
        {
            name: "Pristine Titanium Ore",
            image: "ore/T5_ORE_LEVEL4.png",
            item_value: 85,
            tier: 5,
            enchant: 4,
        },
        {
            name: "Runite Ore",
            image: "ore/T6_ORE.png",
            item_value: 8,
            tier: 6,
            enchant: 0,
        },
        {
            name: "Uncommon Runite Ore",
            image: "ore/T6_ORE_LEVEL1.png",
            item_value: 16,
            tier: 6,
            enchant: 1,
        },
        {
            name: "Rare Runite Ore",
            image: "ore/T6_ORE_LEVEL2.png",
            item_value: 32,
            tier: 6,
            enchant: 2,
        },
        {
            name: "Exceptional Runite Ore",
            image: "ore/T6_ORE_LEVEL3.png",
            item_value: 64,
            tier: 6,
            enchant: 3,
        },
        {
            name: "Pristine Runite Ore",
            image: "ore/T6_ORE_LEVEL4.png",
            item_value: 128,
            tier: 6,
            enchant: 4,
        },
        {
            name: "Meteorite Ore",
            image: "ore/T7_ORE.png",
            item_value: 12,
            tier: 7,
            enchant: 0,
        },
        {
            name: "Uncommon Meteorite Ore",
            image: "ore/T7_ORE_LEVEL1.png",
            item_value: 25,
            tier: 7,
            enchant: 1,
        },
        {
            name: "Rare Meteorite Ore",
            image: "ore/T7_ORE_LEVEL2.png",
            item_value: 51,
            tier: 7,
            enchant: 2,
        },
        {
            name: "Exceptional Meteorite Ore",
            image: "ore/T7_ORE_LEVEL3.png",
            item_value: 102,
            tier: 7,
            enchant: 3,
        },
        {
            name: "Pristine Meteorite Ore",
            image: "ore/T7_ORE_LEVEL4.png",
            item_value: 204,
            tier: 7,
            enchant: 4,
        },
        {
            name: "Adamantium Ore",
            image: "ore/T8_ORE.png",
            item_value: 25,
            tier: 8,
            enchant: 0,
        },
        {
            name: "Uncommon Adamantium Ore",
            image: "ore/T8_ORE_LEVEL1.png",
            item_value: 51,
            tier: 8,
            enchant: 1,
        },
        {
            name: "Rare Adamantium Ore",
            image: "ore/T8_ORE_LEVEL2.png",
            item_value: 102,
            tier: 8,
            enchant: 2,
        },
        {
            name: "Exceptional Adamantium Ore",
            image: "ore/T8_ORE_LEVEL3.png",
            item_value: 204,
            tier: 8,
            enchant: 3,
        },
        {
            name: "Pristine Adamantium Ore",
            image: "ore/T8_ORE_LEVEL4.png",
            item_value: 409,
            tier: 8,
            enchant: 4,
        }
    ],
    hide: [
        {
            name: "Rugged Hide",
            image: "hide/T2_HIDE.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
        },
        {
            name: "Thin Hide",
            image: "hide/T3_HIDE.png",
            item_value: 2,
            tier: 3,
            enchant: 0,
        },
        {
            name: "Medium Hide",
            image: "hide/T4_HIDE.png",
            item_value: 4,
            tier: 4,
            enchant: 0,
        },
        {
            name: "Uncommon Medium Hide",
            image: "hide/T4_HIDE_LEVEL1.png",
            item_value: 12,
            tier: 4,
            enchant: 1,
        },
        {
            name: "Rare Medium Hide",
            image: "hide/T4_HIDE_LEVEL2.png",
            item_value: 28,
            tier: 4,
            enchant: 2,
        },
        {
            name: "Exceptional Medium Hide",
            image: "hide/T4_HIDE_LEVEL3.png",
            item_value: 60,
            tier: 4,
            enchant: 3,
        },
        {
            name: "Pristine Medium Hide",
            image: "hide/T4_HIDE_LEVEL4.png",
            item_value: 120,
            tier: 4,
            enchant: 4,
        },
        {
            name: "Heavy Hide",
            image: "hide/T5_HIDE.png",
            item_value: 4,
            tier: 5,
            enchant: 0,
        },
        {
            name: "Uncommon Heavy Hide",
            image: "hide/T5_HIDE_LEVEL1.png",
            item_value: 10,
            tier: 5,
            enchant: 1,
        },
        {
            name: "Rare Heavy Hide",
            image: "hide/T5_HIDE_LEVEL2.png",
            item_value: 21,
            tier: 5,
            enchant: 2,
        },
        {
            name: "Exceptional Heavy Hide",
            image: "hide/T5_HIDE_LEVEL3.png",
            item_value: 42,
            tier: 5,
            enchant: 3,
        },
        {
            name: "Pristine Heavy Hide",
            image: "hide/T5_HIDE_LEVEL4.png",
            item_value: 85,
            tier: 5,
            enchant: 4,
        },
        {
            name: "Robust Hide",
            image: "hide/T6_HIDE.png",
            item_value: 8,
            tier: 6,
            enchant: 0,
        },
        {
            name: "Uncommon Robust Hide",
            image: "hide/T6_HIDE_LEVEL1.png",
            item_value: 16,
            tier: 6,
            enchant: 1,
        },
        {
            name: "Rare Robust Hide",
            image: "hide/T6_HIDE_LEVEL2.png",
            item_value: 32,
            tier: 6,
            enchant: 2,
        },
        {
            name: "Exceptional Robust Hide",
            image: "hide/T6_HIDE_LEVEL3.png",
            item_value: 64,
            tier: 6,
            enchant: 3,
        },
        {
            name: "Pristine Robust Hide",
            image: "hide/T6_HIDE_LEVEL4.png",
            item_value: 128,
            tier: 6,
            enchant: 4,
        },
        {
            name: "Thick Hide",
            image: "hide/T7_HIDE.png",
            item_value: 12,
            tier: 7,
            enchant: 0,
        },
        {
            name: "Uncommon Thick Hide",
            image: "hide/T7_HIDE_LEVEL1.png",
            item_value: 25,
            tier: 7,
            enchant: 1,
        },
        {
            name: "Rare Thick Hide",
            image: "hide/T7_HIDE_LEVEL2.png",
            item_value: 51,
            tier: 7,
            enchant: 2,
        },
        {
            name: "Exceptional Thick Hide",
            image: "hide/T7_HIDE_LEVEL3.png",
            item_value: 102,
            tier: 7,
            enchant: 3,
        },
        {
            name: "Pristine Thick Hide",
            image: "hide/T7_HIDE_LEVEL4.png",
            item_value: 204,
            tier: 7,
            enchant: 4,
        },
        {
            name: "Hardened Hide",
            image: "hide/T8_HIDE.png",
            item_value: 25,
            tier: 8,
            enchant: 0,
        },
        {
            name: "Uncommon Hardened Hide",
            image: "hide/T8_HIDE_LEVEL1.png",
            item_value: 51,
            tier: 8,
            enchant: 1,
        },
        {
            name: "Rare Hardened Hide",
            image: "hide/T8_HIDE_LEVEL2.png",
            item_value: 102,
            tier: 8,
            enchant: 2,
        },
        {
            name: "Exceptional Hardened Hide",
            image: "hide/T8_HIDE_LEVEL3.png",
            item_value: 204,
            tier: 8,
            enchant: 3,
        },
        {
            name: "Pristine Hardened Hide",
            image: "hide/T8_HIDE_LEVEL4.png",
            item_value: 409,
            tier: 8,
            enchant: 4,
        }
    ],
    wood: [
        {
            name: "Birch Logs",
            image: "wood/T2_WOOD.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
        },
        {
            name: "Chestnut Logs",
            image: "wood/T3_WOOD.png",
            item_value: 2,
            tier: 3,
            enchant: 0,
        },
        {
            name: "Pine Logs",
            image: "wood/T4_WOOD.png",
            item_value: 4,
            tier: 4,
            enchant: 0,
        },
        {
            name: "Uncommon Pine Logs",
            image: "wood/T4_WOOD_LEVEL1.png",
            item_value: 12,
            tier: 4,
            enchant: 1,
        },
        {
            name: "Rare Pine Logs",
            image: "wood/T4_WOOD_LEVEL2.png",
            item_value: 28,
            tier: 4,
            enchant: 2,
        },
        {
            name: "Exceptional Pine Logs",
            image: "wood/T4_WOOD_LEVEL3.png",
            item_value: 60,
            tier: 4,
            enchant: 3,
        },
        {
            name: "Pristine Pine Logs",
            image: "wood/T4_WOOD_LEVEL4.png",
            item_value: 120,
            tier: 4,
            enchant: 4,
        },
        {
            name: "Cedar Logs",
            image: "wood/T5_WOOD.png",
            item_value: 4,
            tier: 5,
            enchant: 0,
        },
        {
            name: "Uncommon Cedar Logs",
            image: "wood/T5_WOOD_LEVEL1.png",
            item_value: 10,
            tier: 5,
            enchant: 1,
        },
        {
            name: "Rare Cedar Logs",
            image: "wood/T5_WOOD_LEVEL2.png",
            item_value: 21,
            tier: 5,
            enchant: 2,
        },
        {
            name: "Exceptional Cedar Logs",
            image: "wood/T5_WOOD_LEVEL3.png",
            item_value: 42,
            tier: 5,
            enchant: 3,
        },
        {
            name: "Pristine Cedar Logs",
            image: "wood/T5_WOOD_LEVEL4.png",
            item_value: 85,
            tier: 5,
            enchant: 4,
        },
        {
            name: "Bloodoak Logs",
            image: "wood/T6_WOOD.png",
            item_value: 8,
            tier: 6,
            enchant: 0,
        },
        {
            name: "Uncommon Bloodoak Logs",
            image: "wood/T6_WOOD_LEVEL1.png",
            item_value: 16,
            tier: 6,
            enchant: 1,
        },
        {
            name: "Rare Bloodoak Logs",
            image: "wood/T6_WOOD_LEVEL2.png",
            item_value: 32,
            tier: 6,
            enchant: 2,
        },
        {
            name: "Exceptional Bloodoak Logs",
            image: "wood/T6_WOOD_LEVEL3.png",
            item_value: 64,
            tier: 6,
            enchant: 3,
        },
        {
            name: "Pristine Bloodoak Logs",
            image: "wood/T6_WOOD_LEVEL4.png",
            item_value: 128,
            tier: 6,
            enchant: 4,
        },
        {
            name: "Ashenbark Logs",
            image: "wood/T7_WOOD.png",
            item_value: 12,
            tier: 7,
            enchant: 0,
        },
        {
            name: "Uncommon Ashenbark Logs",
            image: "wood/T7_WOOD_LEVEL1.png",
            item_value: 25,
            tier: 7,
            enchant: 1,
        },
        {
            name: "Rare Ashenbark Logs",
            image: "wood/T7_WOOD_LEVEL2.png",
            item_value: 51,
            tier: 7,
            enchant: 2,
        },
        {
            name: "Exceptional Ashenbark Logs",
            image: "wood/T7_WOOD_LEVEL3.png",
            item_value: 102,
            tier: 7,
            enchant: 3,
        },
        {
            name: "Pristine Ashenbark Logs",
            image: "wood/T7_WOOD_LEVEL4.png",
            item_value: 204,
            tier: 7,
            enchant: 4,
        },
        {
            name: "Whitewood Logs",
            image: "wood/T8_WOOD.png",
            item_value: 25,
            tier: 8,
            enchant: 0,
        },
        {
            name: "Uncommon Whitewood Logs",
            image: "wood/T8_WOOD_LEVEL1.png",
            item_value: 51,
            tier: 8,
            enchant: 1,
        },
        {
            name: "Rare Whitewood Logs",
            image: "wood/T8_WOOD_LEVEL2.png",
            item_value: 102,
            tier: 8,
            enchant: 2,
        },
        {
            name: "Exceptional Whitewood Logs",
            image: "wood/T8_WOOD_LEVEL3.png",
            item_value: 204,
            tier: 8,
            enchant: 3,
        },
        {
            name: "Pristine Whitewood Logs",
            image: "wood/T8_WOOD_LEVEL4.png",
            item_value: 409,
            tier: 8,
            enchant: 4,
        }
    ]
}

const products = {
    cloth: [
        {
            name: "Simple Cloth",
            image: "cloth/T2_CLOTH.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
            focus_cost: 18,
        },
        {
            name: "Neat Cloth",
            image: "cloth/T3_CLOTH.png",
            item_value: 8,
            tier: 3,
            enchant: 0,
            focus_cost: 31,
        },
        {
            name: "Fine Cloth",
            image: "cloth/T4_CLOTH.png",
            item_value: 16,
            tier: 4,
            enchant: 0,
            focus_cost: 54,
        },
        {
            name: "Uncommon Fine Cloth",
            image: "cloth/T4_CLOTH_LEVEL1.png",
            item_value: 32,
            tier: 4,
            enchant: 1,
            focus_cost: 94,
        },
        {
            name: "Rare Fine Cloth",
            image: "cloth/T4_CLOTH_LEVEL2.png",
            item_value: 64,
            tier: 4,
            enchant: 2,
            focus_cost: 164,
        },
        {
            name: "Exceptional Fine Cloth",
            image: "cloth/T4_CLOTH_LEVEL3.png",
            item_value: 128,
            tier: 4,
            enchant: 3,
            focus_cost: 287,
        },
        {
            name: "Pristine Fine Cloth",
            image: "cloth/T4_CLOTH_LEVEL4.png",
            item_value: 256,
            tier: 4,
            enchant: 4,
            focus_cost: 503,
        },
        {
            name: "Ornate Cloth",
            image: "cloth/T5_CLOTH.png",
            item_value: 32,
            tier: 5,
            enchant: 0,
            focus_cost: 94,
        },
        {
            name: "Uncommon Ornate Cloth",
            image: "cloth/T5_CLOTH_LEVEL1.png",
            item_value: 64,
            tier: 5,
            enchant: 1,
            focus_cost: 164,
        },
        {
            name: "Rare Ornate Cloth",
            image: "cloth/T5_CLOTH_LEVEL2.png",
            item_value: 128,
            tier: 5,
            enchant: 2,
            focus_cost: 287,
        },
        {
            name: "Exceptional Ornate Cloth",
            image: "cloth/T5_CLOTH_LEVEL3.png",
            item_value: 256,
            tier: 5,
            enchant: 3,
            focus_cost: 503,
        },
        {
            name: "Pristine Ornate Cloth",
            image: "cloth/T5_CLOTH_LEVEL4.png",
            item_value: 512,
            tier: 5,
            enchant: 4,
            focus_cost: 880,
        },
        {
            name: "Lavish Cloth",
            image: "cloth/T6_CLOTH.png",
            item_value: 64,
            tier: 6,
            enchant: 0,
            focus_cost: 164,
        },
        {
            name: "Uncommon Lavish Cloth",
            image: "cloth/T6_CLOTH_LEVEL1.png",
            item_value: 128,
            tier: 6,
            enchant: 1,
            focus_cost: 287,
        },
        {
            name: "Rare Lavish Cloth",
            image: "cloth/T6_CLOTH_LEVEL2.png",
            item_value: 256,
            tier: 6,
            enchant: 2,
            focus_cost: 503,
        },
        {
            name: "Exceptional Lavish Cloth",
            image: "cloth/T6_CLOTH_LEVEL3.png",
            item_value: 512,
            tier: 6,
            enchant: 3,
            focus_cost: 880,
        },
        {
            name: "Pristine Lavish Cloth",
            image: "cloth/T6_CLOTH_LEVEL4.png",
            item_value: 1024,
            tier: 6,
            enchant: 4,
            focus_cost: 1539,
        },
        {
            name: "Opulent Cloth",
            image: "cloth/T7_CLOTH.png",
            item_value: 128,
            tier: 7,
            enchant: 0,
            focus_cost: 287,
        },
        {
            name: "Uncommon Opulent Cloth",
            image: "cloth/T7_CLOTH_LEVEL1.png",
            item_value: 256,
            tier: 7,
            enchant: 1,
            focus_cost: 503,
        },
        {
            name: "Rare Opulent Cloth",
            image: "cloth/T7_CLOTH_LEVEL2.png",
            item_value: 512,
            tier: 7,
            enchant: 2,
            focus_cost: 880,
        },
        {
            name: "Exceptional Opulent Cloth",
            image: "cloth/T7_CLOTH_LEVEL3.png",
            item_value: 1024,
            tier: 7,
            enchant: 3,
            focus_cost: 1539,
        },
        {
            name: "Pristine Opulent Cloth",
            image: "cloth/T7_CLOTH_LEVEL4.png",
            item_value: 2048,
            tier: 7,
            enchant: 4,
            focus_cost: 2694,
        },
        {
            name: "Baroque Cloth",
            image: "cloth/T8_CLOTH.png",
            item_value: 256,
            tier: 8,
            enchant: 0,
            focus_cost: 503,
        },
        {
            name: "Uncommon Baroque Cloth",
            image: "cloth/T8_CLOTH_LEVEL1.png",
            item_value: 512,
            tier: 8,
            enchant: 1,
            focus_cost: 880,
        },
        {
            name: "Rare Baroque Cloth",
            image: "cloth/T8_CLOTH_LEVEL2.png",
            item_value: 1024,
            tier: 8,
            enchant: 2,
            focus_cost: 1539,
        },
        {
            name: "Exceptional Baroque Cloth",
            image: "cloth/T8_CLOTH_LEVEL3.png",
            item_value: 2048,
            tier: 8,
            enchant: 3,
            focus_cost: 2694,
        },
        {

            name: "Pristine Baroque Cloth",
            image: "cloth/T8_CLOTH_LEVEL4.png",
            item_value: 4096,
            tier: 8,
            enchant: 4,
            focus_cost: 4714,
        }
    ],
    bar: [
        {
            name: "Copper Bar",
            image: "bar/T2_METALBAR.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
            focus_cost: 18,
        },
        {
            name: "Bronze Bar",
            image: "bar/T3_METALBAR.png",
            item_value: 8,
            tier: 3,
            enchant: 0,
            focus_cost: 31,
        },
        {
            name: "Steel Bar",
            image: "bar/T4_METALBAR.png",
            item_value: 16,
            tier: 4,
            enchant: 0,
            focus_cost: 54,
        },
        {
            name: "Uncommon Steel Bar",
            image: "bar/T4_METALBAR_LEVEL1.png",
            item_value: 32,
            tier: 4,
            enchant: 1,
            focus_cost: 94,
        },
        {
            name: "Rare Steel Bar",
            image: "bar/T4_METALBAR_LEVEL2.png",
            item_value: 64,
            tier: 4,
            enchant: 2,
            focus_cost: 164,
        },
        {
            name: "Exceptional Steel Bar",
            image: "bar/T4_METALBAR_LEVEL3.png",
            item_value: 128,
            tier: 4,
            enchant: 3,
            focus_cost: 287,
        },
        {
            name: "Pristine Steel Bar",
            image: "bar/T4_METALBAR_LEVEL4.png",
            item_value: 256,
            tier: 4,
            enchant: 4,
            focus_cost: 503,
        },
        {
            name: "Titanium Steel Bar",
            image: "bar/T5_METALBAR.png",
            item_value: 32,
            tier: 5,
            enchant: 0,
            focus_cost: 94,
        },
        {
            name: "Uncommon Titanium Steel Bar",
            image: "bar/T5_METALBAR_LEVEL1.png",
            item_value: 64,
            tier: 5,
            enchant: 1,
            focus_cost: 164,
        },
        {
            name: "Rare Titanium Steel Bar",
            image: "bar/T5_METALBAR_LEVEL2.png",
            item_value: 128,
            tier: 5,
            enchant: 2,
            focus_cost: 287,
        },
        {
            name: "Exceptional Titanium Steel Bar",
            image: "bar/T5_METALBAR_LEVEL3.png",
            item_value: 256,
            tier: 5,
            enchant: 3,
            focus_cost: 503,
        },
        {
            name: "Pristine Titanium Steel Bar",
            image: "bar/T5_METALBAR_LEVEL4.png",
            item_value: 512,
            tier: 5,
            enchant: 4,
            focus_cost: 880,
        },
        {
            name: "Runite Steel Bar",
            image: "bar/T6_METALBAR.png",
            item_value: 64,
            tier: 6,
            enchant: 0,
            focus_cost: 164,
        },
        {
            name: "Uncommon Runite Steel Bar",
            image: "bar/T6_METALBAR_LEVEL1.png",
            item_value: 128,
            tier: 6,
            enchant: 1,
            focus_cost: 287,
        },
        {
            name: "Rare Runite Steel Bar",
            image: "bar/T6_METALBAR_LEVEL2.png",
            item_value: 256,
            tier: 6,
            enchant: 2,
            focus_cost: 503,
        },
        {
            name: "Exceptional Runite Steel Bar",
            image: "bar/T6_METALBAR_LEVEL3.png",
            item_value: 512,
            tier: 6,
            enchant: 3,
            focus_cost: 880,
        },
        {
            name: "Pristine Runite Steel Bar",
            image: "bar/T6_METALBAR_LEVEL4.png",
            item_value: 1024,
            tier: 6,
            enchant: 4,
            focus_cost: 1539,
        },
        {
            name: "Meteorite Steel Bar",
            image: "bar/T7_METALBAR.png",
            item_value: 128,
            tier: 7,
            enchant: 0,
            focus_cost: 287,

        },
        {
            name: "Uncommon Meteorite Steel Bar",
            image: "bar/T7_METALBAR_LEVEL1.png",
            item_value: 256,
            tier: 7,
            enchant: 1,
            focus_cost: 503,
        },
        {
            name: "Rare Meteorite Steel Bar",
            image: "bar/T7_METALBAR_LEVEL2.png",
            item_value: 512,
            tier: 7,
            enchant: 2,
            focus_cost: 880,
        },
        {
            name: "Exceptional Meteorite Steel Bar",
            image: "bar/T7_METALBAR_LEVEL3.png",
            item_value: 1024,
            tier: 7,
            enchant: 3,
            focus_cost: 1539,
        },
        {
            name: "Pristine Meteorite Steel Bar",
            image: "bar/T7_METALBAR_LEVEL4.png",
            item_value: 2048,
            tier: 7,
            enchant: 4,
            focus_cost: 2694,
        },
        {
            name: "Adamantium Steel Bar",
            image: "bar/T8_METALBAR.png",
            item_value: 256,
            tier: 8,
            enchant: 0,
            focus_cost: 503,
        },
        {
            name: "Uncommon Adamantium Steel Bar",
            image: "bar/T8_METALBAR_LEVEL1.png",
            item_value: 512,
            tier: 8,
            enchant: 1,
            focus_cost: 880,
        },
        {
            name: "Rare Adamantium Steel Bar",
            image: "bar/T8_METALBAR_LEVEL2.png",
            item_value: 1024,
            tier: 8,
            enchant: 2,
            focus_cost: 1539,
        },
        {
            name: "Exceptional Adamantium Steel Bar",
            image: "bar/T8_METALBAR_LEVEL3.png",
            item_value: 2048,
            tier: 8,
            enchant: 3,
            focus_cost: 2694,
        },
        {

            name: "Pristine Adamantium Steel Bar",
            image: "bar/T8_METALBAR_LEVEL4.png",
            item_value: 4096,
            tier: 8,
            enchant: 4,
            focus_cost: 4714,
        }
    ],
    leather: [
        {
            name: "Stiff Leather",
            image: "leather/T2_LEATHER.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
            focus_cost: 18,
        },
        {
            name: "Thick Leather",
            image: "leather/T3_LEATHER.png",
            item_value: 8,
            tier: 3,
            enchant: 0,
            focus_cost: 31,
        },
        {
            name: "Worked Leather",
            image: "leather/T4_LEATHER.png",
            item_value: 16,
            tier: 4,
            enchant: 0,
            focus_cost: 54,
        },
        {
            name: "Uncommon Worked Leather",
            image: "leather/T4_LEATHER_LEVEL1.png",
            item_value: 32,
            tier: 4,
            enchant: 1,
            focus_cost: 94,
        },
        {
            name: "Rare Worked Leather",
            image: "leather/T4_LEATHER_LEVEL2.png",
            item_value: 64,
            tier: 4,
            enchant: 2,
            focus_cost: 164,
        },
        {
            name: "Exceptional Worked Leather",
            image: "leather/T4_LEATHER_LEVEL3.png",
            item_value: 128,
            tier: 4,
            enchant: 3,
            focus_cost: 287,
        },
        {
            name: "Pristine Worked Leather",
            image: "leather/T4_LEATHER_LEVEL4.png",
            item_value: 256,
            tier: 4,
            enchant: 4,
            focus_cost: 503,
        },
        {
            name: "Cured Leather",
            image: "leather/T5_LEATHER.png",
            item_value: 32,
            tier: 5,
            enchant: 0,
            focus_cost: 94,
        },
        {
            name: "Uncommon Cured Leather",
            image: "leather/T5_LEATHER_LEVEL1.png",
            item_value: 64,
            tier: 5,
            enchant: 1,
            focus_cost: 164,
        },
        {
            name: "Rare Cured Leather",
            image: "leather/T5_LEATHER_LEVEL2.png",
            item_value: 128,
            tier: 5,
            enchant: 2,
            focus_cost: 287,
        },
        {
            name: "Exceptional Cured Leather",
            image: "leather/T5_LEATHER_LEVEL3.png",
            item_value: 256,
            tier: 5,
            enchant: 3,
            focus_cost: 503,
        },
        {
            name: "Pristine Cured Leather",
            image: "leather/T5_LEATHER_LEVEL4.png",
            item_value: 512,
            tier: 5,
            enchant: 4,
            focus_cost: 880,
        },
        {
            name: "Hardened Leather",
            image: "leather/T6_LEATHER.png",
            item_value: 64,
            tier: 6,
            enchant: 0,
            focus_cost: 164,
        },
        {
            name: "Uncommon Hardened Leather",
            image: "leather/T6_LEATHER_LEVEL1.png",
            item_value: 128,
            tier: 6,
            enchant: 1,
            focus_cost: 287,
        },
        {
            name: "Rare Hardened Leather",
            image: "leather/T6_LEATHER_LEVEL2.png",
            item_value: 256,
            tier: 6,
            enchant: 2,
            focus_cost: 503,
        },
        {
            name: "Exceptional Hardened Leather",
            image: "leather/T6_LEATHER_LEVEL3.png",
            item_value: 512,
            tier: 6,
            enchant: 3,
            focus_cost: 880,
        },
        {
            name: "Pristine Hardened Leather",
            image: "leather/T6_LEATHER_LEVEL4.png",
            item_value: 1024,
            tier: 6,
            enchant: 4,
            focus_cost: 1539,
        },
        {
            name: "Reinforced Leather",
            image: "leather/T7_LEATHER.png",
            item_value: 128,
            tier: 7,
            enchant: 0,
            focus_cost: 287,
        },
        {
            name: "Uncommon Reinforced Leather",
            image: "leather/T7_LEATHER_LEVEL1.png",
            item_value: 256,
            tier: 7,
            enchant: 1,
            focus_cost: 503,
        },
        {
            name: "Rare Reinforced Leather",
            image: "leather/T7_LEATHER_LEVEL2.png",
            item_value: 512,
            tier: 7,
            enchant: 2,
            focus_cost: 880,
        },
        {
            name: "Exceptional Reinforced Leather",
            image: "leather/T7_LEATHER_LEVEL3.png",
            item_value: 1024,
            tier: 7,
            enchant: 3,
            focus_cost: 1539,
        },
        {
            name: "Pristine Reinforced Leather",
            image: "leather/T7_LEATHER_LEVEL4.png",
            item_value: 2048,
            tier: 7,
            enchant: 4,
            focus_cost: 2694,
        },
        {
            name: "Fortified Leather",
            image: "leather/T8_LEATHER.png",
            item_value: 256,
            tier: 8,
            enchant: 0,
            focus_cost: 503,
        },
        {
            name: "Uncommon Fortified Leather",
            image: "leather/T8_LEATHER_LEVEL1.png",
            item_value: 512,
            tier: 8,
            enchant: 1,
            focus_cost: 880,
        },
        {
            name: "Rare Fortified Leather",
            image: "leather/T8_LEATHER_LEVEL2.png",
            item_value: 1024,
            tier: 8,
            enchant: 2,
            focus_cost: 1539,
        },
        {
            name: "Exceptional Fortified Leather",
            image: "leather/T8_LEATHER_LEVEL3.png",
            item_value: 2048,
            tier: 8,
            enchant: 3,
            focus_cost: 2694,
        },
        {

            name: "Pristine Fortified Leather",
            image: "leather/T8_LEATHER_LEVEL4.png",
            item_value: 4096,
            tier: 8,
            enchant: 4,
            focus_cost: 4714,
        }
    ],
    plank: [
        {
            name: "Birch Planks",
            image: "planks/T2_PLANKS.png",
            item_value: 4,
            tier: 2,
            enchant: 0,
            focus_cost: 18,
        },
        {
            name: "Chestnut Planks",
            image: "planks/T3_PLANKS.png",
            item_value: 8,
            tier: 3,
            enchant: 0,
            focus_cost: 31,
        },
        {
            name: "Pine Planks",
            image: "planks/T4_PLANKS.png",
            item_value: 16,
            tier: 4,
            enchant: 0,
            focus_cost: 54,
        },
        {
            name: "Uncommon Pine Planks",
            image: "planks/T4_PLANKS_LEVEL1.png",
            item_value: 32,
            tier: 4,
            enchant: 1,
            focus_cost: 94,
        },
        {
            name: "Rare Pine Planks",
            image: "planks/T4_PLANKS_LEVEL2.png",
            item_value: 64,
            tier: 4,
            enchant: 2,
            focus_cost: 164,
        },
        {
            name: "Exceptional Pine Planks",
            image: "planks/T4_PLANKS_LEVEL3.png",
            item_value: 128,
            tier: 4,
            enchant: 3,
            focus_cost: 287,
        },
        {
            name: "Pristine Pine Planks",
            image: "planks/T4_PLANKS_LEVEL4.png",
            item_value: 256,
            tier: 4,
            enchant: 4,
            focus_cost: 503,
        },
        {
            name: "Cedar Planks",
            image: "planks/T5_PLANKS.png",
            item_value: 32,
            tier: 5,
            enchant: 0,
            focus_cost: 94,
        },
        {
            name: "Uncommon Cedar Planks",
            image: "planks/T5_PLANKS_LEVEL1.png",
            item_value: 64,
            tier: 5,
            enchant: 1,
            focus_cost: 164,
        },
        {
            name: "Rare Cedar Planks",
            image: "planks/T5_PLANKS_LEVEL2.png",
            item_value: 128,
            tier: 5,
            enchant: 2,
            focus_cost: 287,
        },
        {
            name: "Exceptional Cedar Planks",
            image: "planks/T5_PLANKS_LEVEL3.png",
            item_value: 256,
            tier: 5,
            enchant: 3,
            focus_cost: 503,
        },
        {
            name: "Pristine Cedar Planks",
            image: "planks/T5_PLANKS_LEVEL4.png",
            item_value: 512,
            tier: 5,
            enchant: 4,
            focus_cost: 880,
        },
        {
            name: "Bloodoak Planks",
            image: "planks/T6_PLANKS.png",
            item_value: 64,
            tier: 6,
            enchant: 0,
            focus_cost: 164,
        },
        {
            name: "Uncommon Bloodoak Planks",
            image: "planks/T6_PLANKS_LEVEL1.png",
            item_value: 128,
            tier: 6,
            enchant: 1,
            focus_cost: 287,
        },
        {
            name: "Rare Bloodoak Planks",
            image: "planks/T6_PLANKS_LEVEL2.png",
            item_value: 256,
            tier: 6,
            enchant: 2,
            focus_cost: 503,
        },
        {
            name: "Exceptional Bloodoak Planks",
            image: "planks/T6_PLANKS_LEVEL3.png",
            item_value: 512,
            tier: 6,
            enchant: 3,
            focus_cost: 880,
        },
        {
            name: "Pristine Bloodoak Planks",
            image: "planks/T6_PLANKS_LEVEL4.png",
            item_value: 1024,
            tier: 6,
            enchant: 4,
            focus_cost: 1539,
        },
        {
            name: "Ashenbark Planks",
            image: "planks/T7_PLANKS.png",
            item_value: 128,
            tier: 7,
            enchant: 0,
            focus_cost: 287,
        },
        {
            name: "Uncommon Ashenbark Planks",
            image: "planks/T7_PLANKS_LEVEL1.png",
            item_value: 256,
            tier: 7,
            enchant: 1,
            focus_cost: 503,
        },
        {
            name: "Rare Ashenbark Planks",
            image: "planks/T7_PLANKS_LEVEL2.png",
            item_value: 512,
            tier: 7,
            enchant: 2,
            focus_cost: 880,
        },
        {
            name: "Exceptional Ashenbark Planks",
            image: "planks/T7_PLANKS_LEVEL3.png",
            item_value: 1024,
            tier: 7,
            enchant: 3,
            focus_cost: 1539,
        },
        {
            name: "Pristine Ashenbark Planks",
            image: "planks/T7_PLANKS_LEVEL4.png",
            item_value: 2048,
            tier: 7,
            enchant: 4,
            focus_cost: 2694,
        },
        {
            name: "Whitewood Planks",
            image: "planks/T8_PLANKS.png",
            item_value: 256,
            tier: 8,
            enchant: 0,
            focus_cost: 503,
        },
        {
            name: "Uncommon Whitewood Planks",
            image: "planks/T8_PLANKS_LEVEL1.png",
            item_value: 512,
            tier: 8,
            enchant: 1,
            focus_cost: 880,
        },
        {
            name: "Rare Whitewood Planks",
            image: "planks/T8_PLANKS_LEVEL2.png",
            item_value: 1024,
            tier: 8,
            enchant: 2,
            focus_cost: 1539,
        },
        {
            name: "Exceptional Whitewood Planks",
            image: "planks/T8_PLANKS_LEVEL3.png",
            item_value: 2048,
            tier: 8,
            enchant: 3,
            focus_cost: 2694,
        },
        {
            name: "Pristine Whitewood Planks",
            image: "planks/T8_PLANKS_LEVEL4.png",
            item_value: 4096,
            tier: 8,
            enchant: 4,
            focus_cost: 4714,
        }
    ]
}

function init() {

    document.getElementById("resouce-table-body").innerHTML = "";

    let refining_resource = document.getElementById("refining-resource").value;
    let refining_resource_list = {};
    let refining_product_list = {};
    switch (refining_resource) {
        case "0":
            refining_resource_list = resources.fiber;
            refining_product_list = products.cloth;
            break;
        case "1":
            refining_resource_list = resources.ore;
            refining_product_list = products.bar;
            break;
        case "2":
            refining_resource_list = resources.hide;
            refining_product_list = products.leather;
            break;
        case "3":
            refining_resource_list = resources.wood;
            refining_product_list = products.plank;
            break;
    }

    // For every element in resources.hide, find the matching    element in products.leather and add to the table
    for (let i = 0; i < refining_resource_list.length; i++) {
        // Add a row to the table
        let row = document.createElement("tr");

        // Add the resource name to the table
        let resource_tier = document.createElement("td");
        resource_tier.innerHTML = refining_resource_list[i].tier + "." + refining_resource_list[i].enchant;
        resource_tier.className = refining_product_list[i].item_value;
        row.appendChild(resource_tier);

        // Add the resource image to the table
        let resource_image = document.createElement("td");
        let resource_image_element = document.createElement("img");
        resource_image_element.src = "images/resources/" + refining_resource_list[i].image;
        resource_image_element.style.width = "75px";
        resource_image_element.style.height = "75px";
        resource_image.appendChild(resource_image_element);
        row.appendChild(resource_image);

        // Price input
        let resource_price_input = document.createElement("td");
        let resource_price_input_element = document.createElement("input");
        resource_price_input_element.id = "resource-price-input-" + refining_resource_list[i].tier + "." + refining_resource_list[i].enchant;
        resource_price_input_element.type = "number";
        resource_price_input_element.value = 0;
        resource_price_input_element.onclick = function () {
            this.select();
        }
        resource_price_input_element.oninput = function () {
            updateNumbers(this);
        }
        resource_price_input.appendChild(resource_price_input_element);
        row.appendChild(resource_price_input);

        // Add the product image to the table
        let product_image = document.createElement("td");
        let product_image_element = document.createElement("img");
        product_image_element.src = "images/resources/" + refining_product_list[i].image;
        product_image_element.style.width = "75px";
        product_image_element.style.height = "75px";
        product_image.appendChild(product_image_element);
        row.appendChild(product_image);

        // Price input
        let product_price = document.createElement("td");
        let product_price_element = document.createElement("input");
        product_price_element.id = "product-price-input-" + refining_product_list[i].tier + "." + refining_product_list[i].enchant;
        product_price_element.type = "number";
        product_price_element.value = 0;
        product_price_element.onclick = function () {
            this.select();
        }
        product_price_element.oninput = function () {
            updateNumbers(this);
        }
        product_price.appendChild(product_price_element);
        row.appendChild(product_price);

        // Profit text
        let profit = document.createElement("td");
        let profit_element = document.createElement("p");
        profit_element.innerHTML = "0";
        profit.appendChild(profit_element);
        row.appendChild(profit);

        // Profit percentage text
        let profit_percentage = document.createElement("td");
        let profit_percentage_element = document.createElement("p");
        profit_percentage_element.innerHTML = "0%";
        profit_percentage.appendChild(profit_percentage_element);
        row.appendChild(profit_percentage);

        // Focus cost text
        let focus_cost = document.createElement("td");
        let focus_cost_element = document.createElement("p");
        focus_cost_element.innerHTML = "0"
        focus_cost_element.id = refining_product_list[i].focus_cost;
        focus_cost.id = "focus-column";
        focus_cost.appendChild(focus_cost_element);
        row.appendChild(focus_cost);

        // Focus profit
        let focus_profit = document.createElement("td");
        let focus_profit_element = document.createElement("p");
        focus_profit_element.innerHTML = "0";
        focus_profit.id = "focus-column";
        focus_profit.appendChild(focus_profit_element);
        row.appendChild(focus_profit);

        // Profit per focus text
        let profit_per_focus = document.createElement("td");
        let profit_per_focus_element = document.createElement("p");
        profit_per_focus_element.innerHTML = "0";
        profit_per_focus.id = "focus-column";
        profit_per_focus.appendChild(profit_per_focus_element);
        row.appendChild(profit_per_focus);

        // Total resource cost text
        let total_resource_cost = document.createElement("td");
        let total_resource_cost_element = document.createElement("p");
        total_resource_cost_element.innerHTML = "0";
        total_resource_cost.id = "detail-column";
        total_resource_cost.appendChild(total_resource_cost_element);
        row.appendChild(total_resource_cost);

        // Station tax detail text
        let station_tax_detail = document.createElement("td");
        let station_tax_detail_element = document.createElement("p");
        station_tax_detail_element.innerHTML = "0";
        station_tax_detail.id = "detail-column";
        station_tax_detail.appendChild(station_tax_detail_element);
        row.appendChild(station_tax_detail);

        // Market tax detail text
        let market_tax_detail = document.createElement("td");
        let market_tax_detail_element = document.createElement("p");
        market_tax_detail_element.innerHTML = "0";
        market_tax_detail.id = "detail-column";
        market_tax_detail.appendChild(market_tax_detail_element);
        row.appendChild(market_tax_detail);

        // Add the row to the table
        document.getElementById("resouce-table-body").appendChild(row);
    }

    loadFromLocalStorage();
    updateMastery();
    updateNumbers();
    updateFocus();
}

function loadFromLocalStorage() {
    let table = document.getElementById("resouce-table-body");
    let refining_resource = document.getElementById("refining-resource").value;
    for (let i = 0; i < table.rows.length; i++) {
        
        let tier = table.rows[i].cells[0].innerHTML;
        let resource_price = localStorage.getItem(refining_resource+"resource-price-input-" + tier);
        let product_price = localStorage.getItem(refining_resource+"product-price-input-" + tier);

        if(resource_price != null) {
            table.rows[i].cells[2].getElementsByTagName("input")[0].value = resource_price;
        }
        if(product_price != null) {
            table.rows[i].cells[4].getElementsByTagName("input")[0].value = product_price;
        }
    }
}

function updateNumbers(element) {

    let refining_resource = document.getElementById("refining-resource").value;

    if(element != null) {
        validateInput(element);
        let element_id = element.id;
        if(element_id != null) {
            if(element_id.includes("product-price-input-") || element_id.includes("resource-price-input-")) {
                let elementValue = document.getElementById(element_id).value;
                if(elementValue < 0 || elementValue == "") {
                    elementValue = 0;
                    document.getElementById(element_id).value = 0;
                }   
                localStorage.setItem(refining_resource+element_id, elementValue);
            }

            if(element_id.includes("refining-mastery-t")) {
                let elementValue = document.getElementById(element_id).value;
                localStorage.setItem(refining_resource+element_id, elementValue);
            }
        }
    }

    let tax = document.getElementById("refining-station-tax").value;
    let return_rate = parseFloat(document.getElementById("refining-station-return-rate").value);
    let craft_amount = document.getElementById("refining-station-amount").value;

    // Loop through every row in the table
    let table = document.getElementById("resouce-table-body");
    for (let i = 0; i < table.rows.length; i++) {

        if(table.rows[i].cells[2].getElementsByTagName("input")[0].value == 0 || table.rows[i].cells[4].getElementsByTagName("input")[0].value == 0) {
            table.rows[i].cells[5].children[0].innerHTML = "0";
            table.rows[i].cells[6].children[0].innerHTML = "0%";
            continue;
        }

        let resource_cost = getResourceCosts()[i];

        let product_price = table.rows[i].cells[4].children[0].value;
        let item_value = table.rows[i].cells[0].className;
        let tax_cost = item_value*(tax/4444)*5;

        let tier = table.rows[i].cells[0].innerHTML;
        
        if(table.rows[i].cells[0].innerHTML == "2.0") tax_cost = 0;
        let profit = (product_price - resource_cost + (resource_cost/100*return_rate) - tax_cost)*craft_amount;

        let market_tax = document.getElementById("refining-market-tax-percentage").value/100;
        let market_tax_cost = (product_price*market_tax)*craft_amount;
        if(document.getElementById("refining-market-tax").checked) {
            profit = profit - market_tax_cost;
        }

        if(document.getElementById("refine-from-t2").checked) {
            if(tier[0] > document.getElementById("refine-from-t2-dropdown").value) {
                let offset = getOffset(tier);
                let previous_profit = table.rows[i-offset].cells[5].children[0].innerHTML;
                profit = profit + parseFloat(previous_profit);
            }
        }

        let profit_percentage = (profit / (resource_cost*craft_amount)) * 100;
        
        table.rows[i].cells[5].children[0].innerHTML = profit.toFixed(0);
        table.rows[i].cells[6].children[0].innerHTML = profit_percentage.toFixed(2) + "%";
        
        table.rows[i].cells[10].children[0].innerHTML = (resource_cost*craft_amount).toFixed(0);
        table.rows[i].cells[11].children[0].innerHTML = (tax_cost*craft_amount).toFixed(0);
        table.rows[i].cells[12].children[0].innerHTML = (market_tax_cost).toFixed(0);

        colorProfits(table.rows[i].cells[5].children[0]);
        colorProfits(table.rows[i].cells[6].children[0]);
    }
    updateFocus();
}

function clearTable(type) {
    let table = document.getElementById("resouce-table-body");
    if(type == "table") {
        let refining_resource = document.getElementById("refining-resource").value;
        for (let i = 0; i < table.rows.length; i++) {
            localStorage.removeItem(refining_resource+"resource-price-input-" + table.rows[i].cells[0].innerHTML);
            localStorage.removeItem(refining_resource+"product-price-input-" + table.rows[i].cells[0].innerHTML);
        }
    } else {
        localStorage.clear();
    
        for(let i = 4; i < 9; i++) {
            document.getElementById("refining-mastery-t" + i).value = 0;
        }
    }

    init();
}

function updateMastery() {
    let refining_resource = document.getElementById("refining-resource").value;
    for(let i = 4; i < 9; i++) {
        let refining_mastery = localStorage.getItem(refining_resource+"refining-mastery-t" + i);
        if(refining_mastery != null) {
            document.getElementById("refining-mastery-t" + i).value = refining_mastery;
        }
        else {
            document.getElementById("refining-mastery-t" + i).value = 0;
        }
    }
}

function updateFocus() {
    let t4_mastery = parseInt(document.getElementById("refining-mastery-t4").value);
    let t5_mastery = parseInt(document.getElementById("refining-mastery-t5").value);
    let t6_mastery = parseInt(document.getElementById("refining-mastery-t6").value);
    let t7_mastery = parseInt(document.getElementById("refining-mastery-t7").value);
    let t8_mastery = parseInt(document.getElementById("refining-mastery-t8").value);

    let craft_amount = parseInt(document.getElementById("refining-station-amount").value);

    let table = document.getElementById("resouce-table-body");
    for (let i = 0; i < table.rows.length; i++) {

        if(table.rows[i].cells[2].getElementsByTagName("input")[0].value == 0 || table.rows[i].cells[4].getElementsByTagName("input")[0].value == 0) continue;
        
        let tier = table.rows[i].cells[0].innerHTML;
        let focus_efficiency = t4_mastery*30 + t5_mastery*30 + t6_mastery*30 + t7_mastery*30 + t8_mastery*30;

        switch (tier[0]) {
            case "4":
                focus_efficiency += t4_mastery*250;
                break;
            case "5":
                focus_efficiency += t5_mastery*250;
                break;
            case "6":
                focus_efficiency += t6_mastery*250;
                break;
            case "7":
                focus_efficiency += t7_mastery*250;
                break;
            case "8":
                focus_efficiency += t8_mastery*250;
                break;
        }

        let base_focus_cost = parseInt(table.rows[i].cells[7].children[0].id);
        let focus_cost = (base_focus_cost*0.5**(focus_efficiency/10000))*craft_amount;

        let tax = document.getElementById("refining-station-tax").value;

        let product_price = table.rows[i].cells[4].children[0].value;
        let item_value = table.rows[i].cells[0].className;
        let tax_cost = item_value*(tax/4444)*5;

        let return_rate;
        switch(document.getElementById("refining-station-return-rate").value) {
            case "15.2": return_rate = 43.5; break;
            case "36.7": return_rate = 53.9; break;
            case "28.5": return_rate = 49.7; break;
            case "20": return_rate = 46; break;
            case "0": return_rate = 37.1; break;
        }

        let resource_cost = getResourceCosts()[i];

        let focus_profit = (product_price - resource_cost + (resource_cost/100*return_rate) - tax_cost)*craft_amount;

        if(document.getElementById("refining-market-tax").checked) {
            focus_profit = focus_profit - (focus_profit*0.065);
        }

        let profit_per_focus = focus_profit/focus_cost;

        table.rows[i].cells[7].children[0].innerHTML = Math.ceil(focus_cost);
        table.rows[i].cells[8].children[0].innerHTML = focus_profit.toFixed(0);
        table.rows[i].cells[9].children[0].innerHTML = profit_per_focus.toFixed(0);

        colorProfits(table.rows[i].cells[8].children[0]);
        colorProfits(table.rows[i].cells[9].children[0]);
    }
}

function validateInput(element) {
    let value = element.value;

    if(element.value[0] == "0" && element.value.length > 1) {
        element.value = element.value.substring(1);
    }

    if (isNaN(value) || value == "" || value == null || value < 0) {
        element.value = 0;
    }

    if(element.id.includes("refining-mastery-t")) {
        if(value > 100) {
            element.value = 100;
            return;
        }
        return;
    }

    if(element.id == "refining-station-tax") {
        if(value > 9999) {
            element.value = 9999;
            return;
        }
    }

    if(element.id == "refining-station-amount") {
        if(value < 1) {
            element.value = 1;
            return;
        }
    }
}

function getResourceCosts() {
    let table = document.getElementById("resouce-table-body");
    // array with prices
    let resource_prices = [];

    for(let i = 0; i < table.rows.length; i++) {
        let tier = table.rows[i].cells[0].innerHTML;
        let resource_price = table.rows[i].cells[2].children[0].value;

        let offset = 5;
        if(tier[0] == "3" || (tier[0] == "4" && tier[2] == "0")) {
            offset = 1;
        } else if (tier[0] == "4" && tier[2] == "1") {
            offset = 2;
        } else if (tier[0] == "4" && tier[2] == "2") {
            offset = 3;
        } else if (tier[0] == "4" && tier[2] == "3") {
            offset = 4;
        }

        let resource_cost;
        switch (tier[0]) {
            case "2":
                resource_cost = resource_price;
                break;
            case "3":
                resource_cost = (resource_price*2)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
            case "4":
                resource_cost = (resource_price*2)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
            case "5":
                resource_cost = (resource_price*3)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
            case "6":
                resource_cost = (resource_price*4)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
            case "7":
                resource_cost = (resource_price*5)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
            case "8":
                resource_cost = (resource_price*5)+parseInt(table.rows[i-offset].cells[4].children[0].value);
                break;
        }

        resource_prices.push(resource_cost);
    }

    return resource_prices;
}

function colorProfits(row) {
    if(row.innerHTML.includes("-")) {
        row.style.color = "red";
    } else {
        row.style.color = "green";
    }
}

function getOffset(tier) {
    let offset = 5;
    if(tier == "3.0" || tier == "4.0") {
        offset = 1;
    } else if (tier == "4.1") {
        offset = 2;
    } else if (tier == "4.2") {
        offset = 3;
    } else if (tier == "4.3") {
        offset = 4;
    }
    return offset;
}

function toggleColumns(type) {
    console.log(type);
    let focus_switch = document.getElementById("profile-settings-focus-columns");
    let detail_switch = document.getElementById("profile-settings-detail-columns");

    let width = !focus_switch.checked ? "100%" : detail_switch.checked ? "75%" : "60%";
    console.log(width);

    document.getElementById("refining-table").classList.toggle("focus-table", focus_switch.checked);
    document.getElementById("refining-table").classList.toggle("detail-table", !detail_switch.checked);

    document.getElementById("refining").style.width = width;
    document.getElementById("refining").style.margin = "0 auto";
}

init();